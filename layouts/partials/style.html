{{- $lightBg := "#f5f3f7" -}}
{{- $lightText := "#2e2834" -}}
{{- $lightLink := "#6b4fa3" -}}
{{- $darkBg := "#1a1620" -}}
{{- $darkText := "#e4e1e8" -}}
{{- $darkLink := "#a68dd4" -}}
<style>
  /* ===== Self-hosted Fonts ===== */
  @font-face {
    font-family: InterVariable;
    font-style: normal;
    font-weight: 100 900;
    font-display: swap;
    src: url("/fonts/InterVariable.woff2") format("woff2");
    unicode-range:
      U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC,
      U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193,
      U+2212, U+2215, U+FEFF, U+FFFD;
  }

  @font-face {
    font-family: "JetBrains Mono";
    font-style: normal;
    font-weight: 400 600;
    font-display: swap;
    src: url("/fonts/JetBrainsMono-latin.woff2") format("woff2");
    unicode-range:
      U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC,
      U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193,
      U+2212, U+2215, U+FEFF, U+FFFD;
  }

  /* ===== CSS Variables ===== */
  :root {
    /* Layout */
    --width: 720px;
    --space: 1.5rem;
    --radius: 5px;

    /* Typography */
    --font-main: Inter, sans-serif;
    --font-secondary: Inter, sans-serif;
    --font-mono: "JetBrains Mono", monospace;
    --font-scale: 1em;
    --font-small: 0.9rem;

    /* Inter font features */
    font-feature-settings:
      "liga" 1,
      "calt" 1,
      "zero" 1;

    /* Computed Colors */
    --surface-color: color-mix(in srgb, var(--link-color) 15%, transparent);
    --visited-color: color-mix(
      in srgb,
      var(--link-color) 50%,
      var(--text-color)
    );
    --muted-text-color: color-mix(
      in srgb,
      var(--text-color) 70%,
      var(--bg-color)
    );
    --border: color-mix(in srgb, var(--text-color) 21%, var(--bg-color));

    /* Light theme */
    --bg-color: {{ $lightBg }};
    --text-color: {{ $lightText }};
    --link-color: {{ $lightLink }};
  }

  /* Dark theme */
  [data-theme="dark"] {
    --bg-color: {{ $darkBg }};
    --text-color: {{ $darkText }};
    --link-color: {{ $darkLink }};
    --border: color-mix(in srgb, var(--bg-color) 82%, var(--text-color));
  }

  /* Dark mode fallback when JS is disabled */
  @media (prefers-color-scheme: dark) {
    :root:not([data-theme="light"]) {
      --bg-color: {{ $darkBg }};
      --text-color: {{ $darkText }};
      --link-color: {{ $darkLink }};
      --border: color-mix(in srgb, var(--bg-color) 82%, var(--text-color));
    }
  }

  /* Use InterVariable for browsers that support font-variation-settings */
  @supports (font-variation-settings: normal) {
    :root {
      --font-main: InterVariable, sans-serif;
      --font-secondary: InterVariable, sans-serif;
    }
  }

  /* ===== Base Styles ===== */

  *,
  *::before,
  *::after {
    box-sizing: border-box;
  }

  html {
    background: var(--bg-color);
    -webkit-text-size-adjust: 100%;
    text-size-adjust: 100%;
  }

  body {
    font-family: var(--font-secondary), sans-serif;
    font-size: var(--font-scale);
    line-height: 1.6;
    color: var(--text-color);
    margin: auto;
    padding: 20px;
    max-width: var(--width);
    text-align: left;
    word-wrap: break-word;
    overflow-wrap: break-word;
    text-rendering: optimizeLegibility;
  }

  main {
    line-height: 1.6;
  }

  /* ===== Typography ===== */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    font-family: var(--font-main), sans-serif;
    color: var(--text-color);
    margin-block: 2rem 0.75rem;
    line-height: 1.3;
    font-weight: 600;
    page-break-after: avoid;
  }

  h1 {
    font-size: 1.75rem;
  }

  h2 {
    font-size: 1.5rem;
  }

  h3 {
    font-size: 1.25rem;
  }

  h4 {
    font-size: 1.1rem;
  }

  p {
    margin-block: var(--space);
  }

  h1 + p {
    margin-block: 0 var(--space);
  }

  strong,
  b {
    color: var(--text-color);
    font-weight: 600;
  }

  time {
    font-family: var(--font-mono);
    font-style: normal;
    font-size: var(--font-small);
    color: var(--muted-text-color);
  }

  /* ===== Links ===== */
  a {
    color: var(--link-color);
    cursor: pointer;
    text-decoration: none;
  }

  a:hover {
    text-decoration: underline;
  }

  nav a {
    margin-right: 8px;
  }

  /* ===== Lists ===== */
  ul,
  ol {
    margin-block: var(--space);
    padding-inline-start: 1.6rem;
  }

  li + li {
    margin-block-start: 0.25rem;
  }

  li > ul,
  li > ol {
    margin-block: 0.25rem;
    margin-inline: 0;
  }

  /* ===== Blockquotes ===== */
  blockquote {
    margin-block: calc(var(--space) * 1.25);
    margin-inline: 0;
    padding: 0.9rem 1.2rem;
    background: var(--surface-color);
    border-inline-start: 3px solid var(--link-color);
    border-radius: 0 var(--radius) var(--radius) 0;
    color: var(--text-color);
  }

  blockquote > *:first-child {
    margin-block-start: 0;
  }

  blockquote > *:last-child {
    margin-block-end: 0;
  }

  blockquote cite {
    display: block;
    margin-block-start: 0.6rem;
    font-style: normal;
    font-size: var(--font-small);
    color: color-mix(in srgb, var(--muted-text-color) 70%, var(--text-color));
  }

  blockquote cite::before {
    content: "â€” ";
  }

  /* ===== Code ===== */
  code,
  pre {
    font-family: var(--font-mono);
    font-size: 0.875em;
  }

  :not(pre) > code {
    padding: 2px 4px;
    border-radius: var(--radius);
    background: var(--surface-color);
  }

  .highlight pre {
    padding: 1rem 0;
    border-radius: var(--radius);
    display: block;
    overflow-x: auto;
  }

  .highlight pre code {
    display: inline-block;
    min-width: 100%;
  }

  mark {
    background: rgba(255, 150, 120, 0.4);
    padding: 1px 3px;
    transform: skewX(-3deg);
    display: inline-block;
  }

  kbd {
    font-family: var(--font-mono);
    font-feature-settings: normal;
    background: var(--surface-color);
    padding: 2px 6px;
    margin: 0 2px;
    font-size: calc(var(--font-scale) * 0.95);
    border: 1px solid var(--link-color);
    border-radius: 4px;
    display: inline-block;
    transform: perspective(200px) rotateX(12deg);
    box-shadow:
      0 3px 0 var(--link-color),
      0 4px 4px rgba(0, 0, 0, 0.3);
  }

  /* ===== Media ===== */
  img {
    max-width: 100%;
    height: auto;
    border-radius: var(--radius);
  }

  figure {
    margin: var(--space) 0;
  }

  figure img {
    display: block;
  }

  figcaption {
    text-align: center;
    font-size: var(--font-small);
    color: var(--muted-text-color);
    font-style: italic;
    margin-top: 0.75rem;
  }

  figcaption p {
    margin: 1rem;
  }

  table {
    width: 100%;
  }

  hr {
    margin-block: calc(var(--space) * 1.5);
    margin-inline: 0;
    border: none;
    border-block-start: 1px solid var(--border);
  }

  /* ===== Interactive Elements ===== */
  button {
    margin: 0;
    cursor: pointer;
  }

  /* Theme toggle button styled as link */
  #theme-toggle {
    background: none;
    border: none;
    padding: 0;
    color: var(--link-color);
    font-family: inherit;
    font-size: inherit;
    text-decoration: none;
  }

  #theme-toggle:hover {
    text-decoration: underline;
  }

  /* ===== Layout Components ===== */
  .title:hover {
    text-decoration: none;
  }

  .title h1 {
    font-size: 1.5em;
  }

  .inline {
    width: auto !important;
  }

  footer {
    margin-block-start: 4rem;
    text-align: center;
    font-size: var(--font-small);
    color: var(--muted-text-color);
  }

  footer p {
    margin-block: 0.5rem;
  }

  /* ===== Blog Post List ===== */
  ul.blog-posts {
    list-style-type: none;
    margin-block: var(--space);
    margin-inline: 0;
    padding: 0;
    margin-block-end: 2rem;
  }

  ul.blog-posts li {
    display: flex;
    align-items: baseline;
    gap: 1.3rem;
  }

  ul.blog-posts li + li {
    margin-block-start: 0.25rem;
  }

  ul.blog-posts li:last-child {
    margin-block-end: 0;
  }

  ul.blog-posts li span {
    flex: 0 0 auto;
  }

  ul.blog-posts time {
    flex-shrink: 0;
  }

  ul.blog-posts li a:visited {
    color: var(--visited-color);
  }

  /* ===== Tags List ===== */
  .tags-list {
    margin-block-start: 2rem;
    font-size: var(--font-small);
  }

  /* ===== Table of Contents ===== */
  .toc {
    margin-block: var(--space);
    padding: 1rem;
    background: var(--surface-color);
    border-radius: var(--radius);
    font-size: var(--font-small);
  }

  .toc summary {
    cursor: pointer;
    font-weight: 600;
    color: var(--text-color);
  }

  .toc summary:hover {
    color: var(--link-color);
  }

  .toc #TableOfContents {
    margin-block-start: 0.75rem;
  }

  .toc #TableOfContents ul {
    margin-block: 0;
    padding-inline-start: 1.2rem;
    list-style: none;
  }

  .toc #TableOfContents > ul {
    padding-inline-start: 0;
  }

  .toc #TableOfContents li {
    margin-block: 0.25rem;
  }

  .toc #TableOfContents a {
    color: var(--text-color);
    text-decoration: none;
  }

  .toc #TableOfContents a:hover {
    color: var(--link-color);
    text-decoration: underline;
  }
</style>
